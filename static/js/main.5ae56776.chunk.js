(this["webpackJsonpjssp-frontend"]=this["webpackJsonpjssp-frontend"]||[]).push([[0],{44:function(e,t,a){},60:function(e,t,a){e.exports=a(99)},65:function(e,t,a){},67:function(e,t,a){},68:function(e,t,a){},69:function(e,t,a){},70:function(e,t,a){},71:function(e,t,a){},99:function(e,t,a){"use strict";a.r(t);var n=a(0),i=a.n(n),r=a(52),o=a.n(r),c=(a(65),a(39)),l=a.n(c),s=a(2),m=a(53),u=a(3),h=a(4),d=a(5),p=a(6);a(67);var f=a(8);a(68);function b(e){var t=e.id?e.id:Math.random().toString(36).substr(2);return i.a.createElement("div",{className:"form-group"},e.label?i.a.createElement("label",{htmlFor:t},e.label):null,i.a.createElement("input",{value:e.value,onChange:e.onChange,type:e.type?e.type:"text",className:"form-control",id:t,"aria-describedby":e.label,placeholder:e.placeholder}),e.smallLabel?i.a.createElement("small",{id:"id",className:"form-text text-muted"},e.smallLabel):null)}function g(e){var t=Object(n.useState)(new Set(e.selectedValues?e.selectedValues:[])),a=Object(f.a)(t,2),r=a[0],o=a[1];return Object(n.useEffect)((function(){o(new Set(e.selectedValues))}),[e.selectedValues]),i.a.createElement("div",{className:"form-group"},e.label?i.a.createElement("p",null,e.label):null,e.allOptions.map((function(t,a){return i.a.createElement("div",{key:t.id,class:"form-check form-check-inline"},i.a.createElement("input",{class:"form-check-input",type:"checkbox",id:"".concat(e.name,"-").concat(a),name:e.name,value:t.id,checked:!!r.has(t.id),onChange:function(a){return function(t,a){var n=new Set(r);n.has(a)?n.delete(a):n.add(a),o(n),e.onChange(Array.from(n))}(0,t.id)}}),i.a.createElement("label",{className:"form-check-label",htmlFor:"".concat(e.name,"-").concat(a)},t.name))})))}var E=a(14);function v(e){var t=Object(n.useState)(!1),a=Object(f.a)(t,2),r=a[0],o=a[1],c=Object(n.useState)(e.machine.name),l=Object(f.a)(c,2),s=l[0],m=l[1],u=Object(n.useState)(e.machine.categories),h=Object(f.a)(u,2),d=h[0],p=h[1];if(r)return i.a.createElement("tr",{key:e.machine.id},i.a.createElement("td",null,e.machine.id),i.a.createElement("td",null,i.a.createElement("input",{value:s,onChange:function(e){return m(e.target.value)}})),i.a.createElement("td",null,i.a.createElement(g,{onChange:function(e){console.log("updating categories",e),p(e)},allOptions:e.categoryOptions,selectedValues:d,name:"category-select-edit-".concat(e.machine.id)})),i.a.createElement("td",null,i.a.createElement("div",{className:"d-flex justify-content-around"},i.a.createElement("button",{onClick:function(){var t={id:e.machine.id,name:s,categories:d};console.log("updated machines ",t),e.updateMachine({id:e.machine.id,name:s,categories:d}),o(!1)}},"Save"),i.a.createElement("button",{onClick:function(){o(!1)}},"Cancel"))));var b=new Map;return e.categoryOptions.forEach((function(e){b.set(e.id,e)})),i.a.createElement("tr",{key:e.machine.id},i.a.createElement("td",null,e.machine.id),i.a.createElement("td",null,e.machine.name),i.a.createElement("td",null,e.machine.categories.reduce((function(e,t,a){return"".concat(e," ").concat(0===a?"":","," ").concat(b.has(t)?b.get(t).name:"")}),"")),i.a.createElement("td",null,i.a.createElement("div",{className:"d-flex justify-content-around"},i.a.createElement(E.a,{onClick:function(){o(!0)}}),i.a.createElement(E.b,{onClick:function(){return e.deleteCategory(e.category)}}))))}var y=function(e){Object(p.a)(a,e);var t=Object(d.a)(a);function a(e){var n;return Object(u.a)(this,a),(n=t.call(this,e)).handleNameChange=function(e){n.setState({name:e.target.value})},n.handleCategoryChange=function(e){n.setState({categories:e})},n.addMachine=function(e){e.preventDefault(),n.props.createMachine({name:n.state.name,categories:n.state.categories,id:"_"+Math.random().toString(36).substr(2,9)}),n.setState({name:"",categories:[]})},n.state={name:"",categories:[]},n}return Object(h.a)(a,[{key:"render",value:function(){var e=this;return i.a.createElement("div",{className:"kr-card1"},i.a.createElement("h3",null,"Machines"),i.a.createElement("table",{className:"table"},i.a.createElement("thead",null,i.a.createElement("tr",null,i.a.createElement("th",null,"Id"),i.a.createElement("th",null,"Name"),i.a.createElement("td",null,"Categories"),i.a.createElement("th",null,"Actions"))),i.a.createElement("tbody",null,this.props.machines.map((function(t){return i.a.createElement(v,{machine:t,updateMachine:e.props.updateMachine,categoryOptions:e.props.categories})})))),i.a.createElement("div",{className:"kr-card"},i.a.createElement("h3",null," Add a new machine "),i.a.createElement("form",{className:"",onSubmit:this.addMachine},i.a.createElement(b,{id:"machine-name",label:"Name for your machine",smallLabel:"Give your machine a recognizable name",value:this.state.name,onChange:this.handleNameChange}),i.a.createElement(g,{onChange:this.handleCategoryChange,allOptions:this.props.categories,selectedValues:this.state.categories,name:"category-select-new"}),i.a.createElement("button",{type:"submit",className:"btn btn-primary mb-2",disabled:""===this.state.name},"Add Machine"))))}}]),a}(i.a.Component),S=a(20);a(69),a(70);function N(e){var t=Object(n.useState)(!1),a=Object(f.a)(t,2),r=a[0],o=a[1],c=Object(n.useState)(e.category.name),l=Object(f.a)(c,2),s=l[0],m=l[1];return r?i.a.createElement("tr",{key:e.category.id},i.a.createElement("td",null,e.category.id),i.a.createElement("td",null,i.a.createElement("input",{value:s,onChange:function(e){m(e.target.value)}})),i.a.createElement("td",null,i.a.createElement("div",{className:"d-flex justify-content-around"},i.a.createElement("button",{onClick:function(){e.updateCategory(Object(S.a)({},e.category,{name:s})),o(!1)}},"Save"),i.a.createElement("button",{onClick:function(){o(!1)}},"Cancel")))):i.a.createElement("tr",{key:e.category.id},i.a.createElement("td",null,e.category.id),i.a.createElement("td",null,e.category.name),i.a.createElement("td",null,i.a.createElement("div",{className:"d-flex justify-content-around"},i.a.createElement(E.a,{onClick:function(){o(!0)}}),i.a.createElement(E.b,{onClick:function(){return e.deleteCategory(e.category)}}))))}var C=function(e){Object(p.a)(a,e);var t=Object(d.a)(a);function a(e){var n;return Object(u.a)(this,a),(n=t.call(this,e)).handleChange=function(e){n.setState({name:e.target.value}),console.log(e.target.value)},n.handleSubmit=function(e){e.preventDefault(),n.props.createCategory({name:n.state.name,machines:[]}),n.setState({name:""})},n.state={name:""},n}return Object(h.a)(a,[{key:"render",value:function(){var e=this;return i.a.createElement("div",{className:"machines-wrapper__categories kr-card2"},i.a.createElement("h3",null,"Tags"),i.a.createElement("table",{className:"table"},i.a.createElement("thead",null,this.props.categories.length>0&&i.a.createElement("tr",null,i.a.createElement("th",null,"Id"),i.a.createElement("th",null,"Name"),i.a.createElement("td",null,"Actions"))),i.a.createElement("tbody",null,this.props.categories.map((function(t){return i.a.createElement(N,{category:t,updateCategory:e.props.updateCategory,deleteCategory:e.props.deleteCategory})})))),i.a.createElement("div",{className:"kr-card"},i.a.createElement("p",{className:"machines-wrapper__categories--intro"},"Please Enter a new tag below. Once saved, the tags will appear as a selection option in each machine. You'll have to individually apply new tags to existing machines."),i.a.createElement("form",{onSubmit:this.handleSubmit},i.a.createElement(b,{id:"category-input",value:this.state.name,onChange:this.handleChange,label:"Enter new category",smallLabel:"You will be able to apply each category to multiple machines"}),i.a.createElement("button",{type:"submit",className:"btn btn-primary",disabled:""===this.state.name},"Add Category"))))}}]),a}(i.a.Component),j=a(30);function M(e){var t=Object(n.useState)(!1),a=Object(f.a)(t,2),r=a[0],o=a[1],c=Object(n.useState)(e.machines.length>0?e.machines[0].id:void 0),l=Object(f.a)(c,2),m=l[0],u=l[1],h=Object(n.useState)(0),d=Object(f.a)(h,2),p=d[0],b=d[1];Object(n.useEffect)((function(){var t=e.machines.length>0?e.machines[0].id:void 0;u(t)}),[e.machines]);return i.a.createElement("div",{className:"kr-card mb-2"},i.a.createElement("h5",null,e.operationName),i.a.createElement("table",{className:"table table-sm"},i.a.createElement("thead",null,i.a.createElement("tr",null,i.a.createElement("th",null,"Machine Id"),i.a.createElement("th",null,"Time"),i.a.createElement("th",null,"Actions"))),i.a.createElement("tbody",null,e.machineAndTimes.map((function(t,a,n){return i.a.createElement("tr",{key:a},i.a.createElement("td",null,t[0]),i.a.createElement("td",null,t[1]),i.a.createElement("td",null,i.a.createElement("div",{className:"d-flex justify-content-around"},i.a.createElement(E.b,{onClick:function(){return function(t){console.log("deleting ",t);var a=e.machineAndTimes.filter((function(e,a){return a!==t})),n=(e.machines,e.updateOperation),i=Object(j.a)(e,["machines","updateOperation"]);n(Object(S.a)({},i,{machineAndTimes:a}))}(a)}}))))})))),r?i.a.createElement("form",{onSubmit:function(t){t.preventDefault();var a=[m,p],n=(e.machines,e.updateOperation),i=Object(j.a)(e,["machines","updateOperation"]);n(Object(S.a)({},i,{machineAndTimes:[].concat(Object(s.a)(e.machineAndTimes),[a])})),b(0),o(!1)}},i.a.createElement("select",{className:"form-control",onChange:function(e){return u(e.target.value)},value:m},e.machines.map((function(e){return i.a.createElement("option",{value:e.id},e.name)}))),i.a.createElement("input",{className:"form-control",placeholder:"enter time",value:p,onChange:function(e){return b(e.target.value)}}),i.a.createElement("button",null,"Submit"),i.a.createElement("button",{onClick:function(){return o(!1)},className:"button btn-primary mt-1"},"Cancel")):i.a.createElement("button",{onClick:function(){return o(!0)},className:"button btn-primary mt-1"},"Add New Machine Option"))}function O(e){var t=e.id,a=e.name,r=e.operations,o=e.updateJob,c=e.machines,l=Object(n.useState)(""),m=Object(f.a)(l,2),u=m[0],h=m[1],d=Object(n.useState)(!1),p=Object(f.a)(d,2),g=p[0],E=p[1],v=function(t){var a=r.map((function(e){return e.id===t.id?t:e})),n=(e.machines,e.updateJob),i=Object(j.a)(e,["machines","updateJob"]);n(Object(S.a)({},i,{operations:a}))};return i.a.createElement("div",{className:"kr-card mb-3"},i.a.createElement("h3",null,a),i.a.createElement("div",{className:"d-flex flex-wrap align-items-center align-self-center"},r.map((function(e){return i.a.createElement(i.a.Fragment,null,i.a.createElement(M,{id:e.id,key:e.operationName,operationName:e.operationName,machineAndTimes:e.machineAndTimes,machines:c,updateOperation:v}),i.a.createElement("div",{className:"p-3"}," -> "))})),g?i.a.createElement("form",{className:"kr-card",onSubmit:function(e){e.preventDefault();var n={id:t,name:a,operations:[].concat(Object(s.a)(r),[{id:r.reduce((function(e,t){return t.id<=e?e+1:t.id+1}),1),operationName:u,machineAndTimes:[]}])};o(n),h(""),E(!1)}},i.a.createElement(b,{id:"job-new-input",value:u,onChange:function(e){return h(e.target.value)},label:"Enter new Operation",smallLabel:"You will be able to add possible machines after adding an operation"}),i.a.createElement("button",{type:"submit",className:"btn btn-primary",disabled:""===u},"Add new Operation"),i.a.createElement("button",{className:"btn btn-warning ml-1",onClick:function(){return E(!1)}},"Cancel")):i.a.createElement("button",{className:"btn btn-primary",onClick:function(){return E(!0)}},"Add Operation ")))}var k=function(e){var t=Object(n.useState)(""),a=Object(f.a)(t,2),r=a[0],o=a[1];return i.a.createElement("div",{className:"m-5"},i.a.createElement("h3",null,"See SKUs below"),e.jobs.map((function(t){return i.a.createElement(O,{key:t.name,id:t.id,name:t.name,operations:t.operations,updateJob:e.updateJob,machines:e.machines})})),i.a.createElement("form",{className:"kr-card",onSubmit:function(t){t.preventDefault(),e.createJob({name:r,operations:[]}),o("")}},i.a.createElement(b,{id:"job-new-input",value:r,onChange:function(e){o(e.target.value)},label:"Enter new Job (new SKU)",smallLabel:"You will be able to add operations for each job after creating it"}),i.a.createElement("button",{type:"submit",className:"btn btn-primary",disabled:""===r},"Add new Job")))},w=function(e){Object(p.a)(a,e);var t=Object(d.a)(a);function a(){return Object(u.a)(this,a),t.apply(this,arguments)}return Object(h.a)(a,[{key:"render",value:function(){return i.a.createElement("div",null,"I am Parameters Component ")}}]),a}(i.a.Component);var T=function(e){for(var t="".concat(e,"color"),a=0,n=0;n<t.length;n++)a=t.charCodeAt(n)+((a<<5)-a);var i="#";for(n=0;n<3;n++){i+=("00"+(a>>8*n&255).toString(16)).substr(-2)}return i},A=function(e){Object(p.a)(a,e);var t=Object(d.a)(a);function a(e){return Object(u.a)(this,a),t.call(this,e)}return Object(h.a)(a,[{key:"randColor",value:function(){return Math.floor(180*Math.random())}},{key:"render",value:function(){for(var e=[],t=0;t<this.props.schedule.length;t++)if(t%3===0){var a=this.props.schedule[t],n=this.props.schedule[t+1],r=this.props.schedule[t+2],o=100*(r-n)/this.props.maxTime,c=100*n/this.props.maxTime,l={width:"".concat(o,"%"),height:"20px",backgroundColor:"".concat(T(a)),position:"absolute",left:"".concat(c,"%"),transition:"all 1s linear"},s=i.a.createElement("div",{id:"key-".concat(this.props.index,"-").concat(a),className:"job-".concat(a),style:l,"data-start":n,"data-end":r,"data-jobid":a},"Job-",a);e.push(s)}var m={position:"relative",display:"flex",top:"".concat(25*this.props.index,"px")};return i.a.createElement("div",{style:m},e)}}]),a}(i.a.Component),x=function(e,t){console.log("running problemInstance",e,t);var a=e.map((function(e){return function(e){var t=e.operations.reduce((function(e,t){var a=t.machineAndTimes.length;return[].concat(Object(s.a)(e),[a],Object(s.a)(t.machineAndTimes.flat().map((function(e){return parseInt(e)}))))}),[]);return console.log(t),t}(e)})),n=new I(e.length,t.length);return n.jobs=a,n.numMachineByJobs=[],n.jobs.forEach((function(e){for(var t=0,a=0,i=0;i<e.length;i++)i===a&&(t+=1,a=i+2*e[i]+1);n.numMachineByJobs.push(t)})),n};function I(e,t,a){this.numJobs=e,this.numMachines=t,this.numMachineByJobs=a,this.jobs=[]}i.a.Component,a(71);var R=a(29),L=(a(44),function(e){Object(p.a)(a,e);var t=Object(d.a)(a);function a(){return Object(u.a)(this,a),t.apply(this,arguments)}return Object(h.a)(a,[{key:"render",value:function(){for(var e={position:"relative",top:"".concat(25*this.props.index,"px")},t=[],a=10*(this.props.maxTime/10+1),n=0;n<a;n++){var r=100*n/this.props.maxTime,o={left:"".concat(r,"%"),transition:"all 1s linear",position:"absolute"};if(n%10===0){var c=i.a.createElement("span",{style:o},i.a.createElement("div",null,"|"),i.a.createElement("div",null,n));t.push(c)}}return i.a.createElement("div",{style:e},t)}}]),a}(i.a.Component)),_=["Bottle Expansion Mold","Water Cleaning/ Purifying","Water Filling","Bottle Capping","Bottle Labeling","Bottle Expansion Mold 2"],D=function(e){Object(p.a)(a,e);var t=Object(d.a)(a);function a(){return Object(u.a)(this,a),t.apply(this,arguments)}return Object(h.a)(a,[{key:"render",value:function(){var e=this.props.schedule.map((function(e){return e[e.length-1]})),t=Math.max.apply(Math,Object(s.a)(e));return i.a.createElement("div",{className:"ganttChartWithY"},i.a.createElement("div",{className:"ganttChartYAxis"},this.props.schedule.map((function(e,t){var a=_[t];return i.a.createElement("span",{className:"yAxisTick"},"".concat(a," Machine"))}))),i.a.createElement("div",{className:"ganttChartData"},this.props.schedule.map((function(e,a){return i.a.createElement(A,{schedule:e,maxTime:t,index:a})})),i.a.createElement(L,{index:this.props.schedule.length,maxTime:t})))}}]),a}(i.a.Component),W=function(){var e,t,a,n,i;!function(e){e[e.MACHINE=0]="MACHINE",e[e.PERSON=1]="PERSON"}(e||(e={})),function(e){e[e.SIMPLE=0]="SIMPLE",e[e.CAN_RUN_IN_PARALLEL=1]="CAN_RUN_IN_PARALLEL",e[e.CAN_RUN_IN_MULTIPLE_MACINES=2]="CAN_RUN_IN_MULTIPLE_MACINES"}(t||(t={})),function(e){e[e.RANDOM=0]="RANDOM",e[e.HILL_CLIMBING=1]="HILL_CLIMBING",e[e.HILL_CLIMBING_WITH_RESTARTS=2]="HILL_CLIMBING_WITH_RESTARTS"}(a||(a={})),function(e){e[e.FISHERYATES=0]="FISHERYATES",e[e.NORANDOM=1]="NORANDOM"}(n||(n={})),function(e){e[e.ACETAL=0]="ACETAL",e[e.PP=1]="PP"}(i||(i={}));var r=function(){function i(){this.resources=new Map,this.jobs=new Map,this.maxNumberOfSimulations=1e5,this.maxSecondsToRun=30,this.algorithm=a.RANDOM,this.hillClimbingRandomRestartPercent=1,this.totalRestarts=0,this.terminationCriteriaFuncs=this.generateDefaultTerminationCriteriaFunctions(),this.bestMakeSpanLocal=1/0,this.randomAlgorithm=n.FISHERYATES}return i.prototype.addJob=function(e){this.jobs.set(e.id,e)},i.prototype.addOperation=function(e){},i.prototype.updateOperation=function(e){},i.prototype.addMachine=function(t,a,n){var i={id:a=a||Array.from(this.resources.keys()).reduce((function(e,t){return t>=e?t+1:e}),0),name:t,type:e.MACHINE};return this.resources.set(a,i),a},i.prototype.addResource=function(e){if(e.id)return this.resources.set(e.id,e),e.id;var t=Array.from(this.resources.keys()).reduce((function(e,t){return t>=e?t+1:e}),0);return e.id=t,this.resources.set(t,e),t},i.prototype.setSolutionParameters=function(e){e.maxNumberOfSimulations&&(this.maxNumberOfSimulations=e.maxNumberOfSimulations),e.maxSecondsToRun&&(this.maxSecondsToRun=e.maxSecondsToRun),e.algorithm&&(this.algorithm=e.algorithm),e.hillClimbingRandomRestartPercent&&(this.hillClimbingRandomRestartPercent=e.hillClimbingRandomRestartPercent),e.randomAlgorithm&&(this.randomAlgorithm=e.randomAlgorithm)},i.prototype.addTerminationCriteria=function(e){return this.terminationCriteriaFuncs.push(e),this.terminationCriteriaFuncs},i.prototype.isOperationComplex=function(e){return e.hasOwnProperty("type")&&e.hasOwnProperty("operations")},i.prototype.FisherYatesShuffle=function(e){for(var t,a,n=e.length;0!==n;)a=Math.floor(Math.random()*n),t=e[n-=1],e[n]=e[a],e[a]=t;return e},i.prototype.countOperations=function(e){var a=this,n=0;return e.operations.forEach((function(e){if(a.isOperationComplex(e)){var i=e;if(i.type===t.CAN_RUN_IN_PARALLEL){var r=i.operations;n+=r.length}else n+=1}else n+=1})),n},i.prototype.oneDToGanttChart=function(e){var a=this,n=new Map;this.resources.forEach((function(e,t){n.set(t,[])}));var i=new Map;this.jobs.forEach((function(e,t){i.set(t,0)}));var r=new Map;this.jobs.forEach((function(e,t){r.set(t,0)}));var o=function(e,t){var i=n.get(e.machine),o=0===i.length?0:i[i.length-1]+1,c=r.get(t),l=a.jobs.get(t),s=Math.max(o,c),m=s+e.time*l.requiredInventory;return 0===i.length?n.set(e.machine,[t,s,m]):(i.push(t),i.push(s),i.push(m),n.set(e.machine,i)),m};return e.forEach((function(e,n,c){var l=a.jobs.get(e),s=i.get(e),m=l.operations[s];if(a.isOperationComplex(m)){var u=m;if(u.type===t.CAN_RUN_IN_PARALLEL){var h=u.operations.map((function(t,a){return o(t,e)})),d=Math.max.apply(Math,h);r.set(e,d+1)}else{if(u.type!==t.CAN_RUN_IN_MULTIPLE_MACINES)throw new Error("Type not supported yet");var p=u.operations[Math.floor(Math.random()*u.operations.length)],f=o(p,e);r.set(e,f+1)}}else{f=o(m,e);r.set(e,f+1)}i.set(e,s+1)})),n},i.prototype.onedArrayOfJobs=function(){var e=this,t=function(){var t=[];return e.jobs.forEach((function(e,a){var n=e.operations.length,i=new Array(n).fill(a);t=t.concat(i)})),e.randomAlgorithm===n.NORANDOM?t:t=e.FisherYatesShuffle(t)},i=function(e){for(var t=Math.floor(Math.random()*e.length),a=Math.floor(Math.random()*e.length);e[t]===e[a];)a=Math.floor(Math.random()*e.length);var n=e[t];return e[t]=e[a],e[a]=n,e};if(!this.best1Dsolution)return t();if(this.algorithm===a.RANDOM)return t();if(this.algorithm===a.HILL_CLIMBING)return i(this.best1Dsolution);if(this.algorithm===a.HILL_CLIMBING_WITH_RESTARTS){if(100*Math.random()<this.hillClimbingRandomRestartPercent){this.totalRestarts+=1;var r=t();return this.best1DSolutionLocal=r,this.bestMakeSpanLocal=1/0,r}return i(this.best1DSolutionLocal)}throw new Error("Not implemented")},i.prototype.costFunction=function(e){return Array.from(e.values()).reduce((function(e,t){var a=t[t.length-1];return a>e?a:e}),0)},i.prototype.generateDefaultTerminationCriteriaFunctions=function(){var e=[];if(this.maxNumberOfSimulations){e.push((function(e){return e.currentSimulationIndex>=e.maxNumberOfSimulations}))}if(this.maxSecondsToRun){e.push((function(e){var t=new Date(e.simulationStartTime.getTime());return t.setSeconds(t.getSeconds()+e.maxSecondsToRun),new Date>t}))}return e},i.prototype.solve=function(e){console.log("solving");for(var t,n,i=0,r=1/0,c=0,l=[[],[]],s=[[],[]],m={currentSimulationIndex:i,simulationStartTime:new Date,maxNumberOfSimulations:this.maxNumberOfSimulations,maxSecondsToRun:this.maxSecondsToRun,algorithm:this.algorithm};!t;){m.currentSimulationIndex=i,t=this.terminationCriteriaFuncs.map((function(e){return e(m)})).reduce((function(e,t){return!!t||e}),!1);var u=this.onedArrayOfJobs(),h=this.oneDToGanttChart(u),d=this.costFunction(h);if(this.bestMakeSpanLocal===1/0&&(l[0].push(i-1),l[1].push(r)),d<r)r=d,n=h,this.best1Dsolution=u,c=i,e("Got New MakeSpan"),e({type:"newSchedule",schedule:n,makeSpan:d,minMakeSpanDetectedIteration:i}),o(1e3),s[0].push(i),s[1].push(d);this.algorithm===a.HILL_CLIMBING_WITH_RESTARTS&&d<this.bestMakeSpanLocal&&(this.bestMakeSpanLocal=d,this.best1DSolutionLocal=u,l[0].push(i),l[1].push(d));if((i+=1)<100?i%1===0:i<1e3?i%100===0:i<1e4?i%1e3===0:i%1e5?i%1e5===0:i%25e4===0)e({type:"iterationCount",iteration:i,localMakeSpanHistory:l,bestMakeSpanHistory:s}),l[0].length=0,l[1].length=0,s[0].length=0,s[1].length=0}s.length>0&&(console.log("sending last round of data."),s[0].push(i),s[1].push(r),l[0].push(i),l[1].push(r),e({type:"iterationCount",iteration:i,bestMakeSpanHistory:s,localMakeSpanHistory:l}));return{bestGanttChart:n,bestMakeSpan:r,bestMakeSpanIndex:c}},i}();function o(e){for(var t=(new Date).getTime();t+e>=(new Date).getTime(););}onmessage=function(e){var i=e.data,o=(i.problem,i.algorithmRepetition),c=i.algorithmMaxTimeSecs,l=i.algorithmType,s=i.machines,m=i.jobs,u=new r;s.forEach((function(e,t){u.addMachine(e.name,e.id)})),m.forEach((function(e,a){var n=[];e.operations.forEach((function(e,a){if(0!==e.machineAndTimes.length)if(e.machineAndTimes.length>1){var i={type:t.CAN_RUN_IN_MULTIPLE_MACINES,operations:e.machineAndTimes.map((function(e){return{machine:parseInt(e[0]),time:parseInt(e[1])}}))};n.push(i)}else n.push({machine:parseInt(e.machineAndTimes[0][0]),time:parseInt(e.machineAndTimes[0][0])})})),u.addJob({id:e.id,name:e.name,operations:n,requiredInventory:1})}));var h={maxNumberOfSimulations:o,maxSecondsToRun:c,algorithm:"random"===l?a.RANDOM:"hillClimbing"===l?a.HILL_CLIMBING:a.HILL_CLIMBING_WITH_RESTARTS,hillClimbingRandomRestartPercent:.1,randomAlgorithm:n.FISHERYATES};u.setSolutionParameters(h);var d=u.solve(this.postMessage);console.log("returning bestGanttChart"),console.log(d);var p="Received from main: "+e.data;this.postMessage(p)}}.toString();W=W.substring(W.indexOf("{")+1,W.lastIndexOf("}"));var B=new Blob([W],{type:"application/javascript"}),J=URL.createObjectURL(B);console.log("generated worker script is ",J);var P=J;a(72);a(73);var H=a(18),F=(n.Component,a(55)),U=(a(96),new I(5,6));U.jobs=[[2,0,10,5,20,1,1,10,1,2,10,1,3,10,1,4,8,1,4,10,1,4,10],[2,0,50,5,30,1,1,15,1,2,10,1,3,10],[2,0,30,5,50,1,1,12,1,2,20,1,3,10,1,4,16],[2,0,15,5,20,1,1,30,1,2,20,1,3,10,1,4,10],[1,2,120]],U.numMachineByJobs=[],U.jobs.forEach((function(e){for(var t=0,a=0,n=0;n<e.length;n++)n===a&&(t+=1,a=n+2*e[n]+1);U.numMachineByJobs.push(t)}));var G=function(e){Object(p.a)(a,e);var t=Object(d.a)(a);function a(e){var n;return Object(u.a)(this,a),(n=t.call(this,e)).startJobShopWorker=function(){n.setState({simulationStartTime:Math.round((new Date).getTime()/1e3)}),console.log("started worker");var e=new Worker(P);e.addEventListener("message",(function(e){if(e.data&&"iterationCount"===e.data.type){var t,a,i="bestMakeSpanHistory";"hillClimbingRestarts"===n.state.algorithmType&&(i="localMakeSpanHistory"),setTimeout((function(a){t=[].concat(Object(s.a)(n.state.uPlotRef.data[0]),Object(s.a)(e.data[i][0]))})),setTimeout((function(t){a=[].concat(Object(s.a)(n.state.uPlotRef.data[1]),Object(s.a)(e.data[i][1]))})),setTimeout((function(){n.state.uPlotRef.setData([t,a],!0)}),0)}else if(e.data&&"newSchedule"===e.data.type){var r=[];e.data.schedule.forEach((function(e,t){r.push(e)})),n.setState({schedule:r,makeSpan:e.data.makeSpan,minMakeSpanDetectedIteration:e.data.minMakeSpanDetectedIteration})}}),!1);var t=x(n.props.jobs,n.props.machines);e.postMessage({algorithmRepetition:n.state.maxAlgorithmRepetition,problem:t,algorithmMaxTimeSecs:n.state.algorithmMaxTimeSecs,algorithmType:n.state.algorithmType,machines:n.props.machines,jobs:n.props.jobs}),n.setState({workerInstance:e})},n.handleChange=function(e){n.setState(Object(R.a)({},e.target.name,e.target.value))},n.handleRestartJobShopWorkerButton=function(e){e.preventDefault(),n.state.workerInstance.terminate(),n.state.uPlotRef.setData([[null],[null]]),n.setState({schedule:[[],[]],makeSpan:1/0,minMakeSpanDetectedIteration:0,iterations:0,makeSpanHistory:[]},n.startJobShopWorker())},n.handleStopWorker=function(e){n.state.workerInstance.terminate()},n.state={schedule:[[],[]],makeSpan:1/0,minMakeSpanDetectedIteration:0,iterations:0,workerInstance:new Worker(P),makeSpanHistory:[],maxAlgorithmRepetition:1e4,algorithmMaxTimeSecs:30,algorithmType:"hillClimbingRestarts",uPlotRef:null,simulationStartTime:Math.round((new Date).getTime()/1e3)},n}return Object(h.a)(a,[{key:"createChart",value:function(){var e={title:"Best MakeSpan over Time/Simulations",width:window.innerWidth-40,height:300,series:[{label:"Simulation Count"},{stroke:"rgb(18, 147, 154)",label:"Makespan",width:2}],axes:[{label:"Simulation Count"},{label:"Makespan"}],scales:{x:{time:!1}}},t=new F.a(e,[[null],[null]],document.getElementById("uplotChart"));this.setState({uPlotRef:t})}},{key:"componentDidMount",value:function(){this.createChart(),this.startJobShopWorker()}},{key:"componentDidUpdate",value:function(e,t,a){e.jobs===this.props.jobs&&e.machines===this.props.machines||(console.log("props changed, so restarting the simulation"),this.state.workerInstance.terminate(),this.startJobShopWorker())}},{key:"componentWillUnmount",value:function(){this.state.workerInstance.terminate()}},{key:"render",value:function(){return i.a.createElement("div",{className:"App"},i.a.createElement("nav",{className:"d-flex factory-navbar bg-color-app-secondary"},i.a.createElement("li",{className:"nav-item no-list-style"},i.a.createElement("select",{className:"form-control ml-2",name:"algorithmType",onChange:this.handleChange,value:this.state.algorithmType},i.a.createElement("option",{value:"random"},"Random Search"),i.a.createElement("option",{value:"hillClimbing"},"Hill Climbing Search"),i.a.createElement("option",{value:"hillClimbingRestarts"},"Hill Climbing With Restarts"))),i.a.createElement("li",{className:"nav-item ml-2 no-list-style"},i.a.createElement("button",{className:"btn btn-outline-danger ml-2",onClick:this.handleStopWorker}," Stop ")),i.a.createElement("li",{className:"nav-item ml-2 no-list-style"},i.a.createElement("button",{className:"btn btn-outline-success",onClick:this.handleRestartJobShopWorkerButton},"  Restart with new settings "))),i.a.createElement("div",{className:"container"},i.a.createElement("div",{className:"row"},i.a.createElement("div",{className:"col"},i.a.createElement("table",{className:" table table-sm mt-2"},i.a.createElement("thead",null,i.a.createElement("tr",null,i.a.createElement("th",{colSpan:2},"Simulation Parameters "))),i.a.createElement("tbody",null,i.a.createElement("tr",null,i.a.createElement("td",null,"Number of Simulations"),i.a.createElement("td",null,this.state.iterations," ")),i.a.createElement("tr",null,i.a.createElement("td",null,"Minimal Makespan Detected"),i.a.createElement("td",null,this.state.makeSpan)),i.a.createElement("tr",null,i.a.createElement("td",null,"Min detected after iteration"),i.a.createElement("td",null,this.state.minMakeSpanDetectedIteration))))),i.a.createElement("div",{className:"col"},i.a.createElement("table",{className:"table table-sm mt-2"},i.a.createElement("thead",null,i.a.createElement("tr",null,i.a.createElement("th",{colSpan:2},"Termination Criteria"))),i.a.createElement("tbody",null,i.a.createElement("tr",null,i.a.createElement("td",null,"Number of Simuations"),i.a.createElement("td",null,i.a.createElement("input",{type:"number",style:{width:"4em"},name:"maxAlgorithmRepetition",onChange:this.handleChange,value:this.state.maxAlgorithmRepetition}))),i.a.createElement("tr",null,i.a.createElement("td",null,"Maximum Time in seconds"),i.a.createElement("td",null,i.a.createElement("input",{type:"number",style:{width:"4em"},name:"algorithmMaxTimeSecs",onChange:this.handleChange,value:this.state.algorithmMaxTimeSecs,className:"form-controll",placeholder:"Max number of iterations"})))))))),i.a.createElement("div",{style:{marginTop:"10px"}},i.a.createElement("div",{id:"uplotChart"})),i.a.createElement("hr",null),i.a.createElement("h6",null,"Schedule with the least makespan"),i.a.createElement(D,{schedule:this.state.schedule}),i.a.createElement("div",{className:"explanation"},i.a.createElement("p",null,"The Chart above shows the order in which each operation in a water bottling plant must run on each machine to complete all bottling activities in the most efficient manner. Watch the chart change as the algorithm finds more and more efficient way to run the factory over time. Simulation is slowed down for demonstration purpose. Run the simulations with different settings below:"),i.a.createElement("hr",null),i.a.createElement("h3",null,"Explanation"),"In this demo, we are trying to optimize how to run a water bottling plant.",i.a.createElement("ul",null,i.a.createElement("li",null,"The machines and the operations required for each job is listed in the machines tab. Feel free to click there to take a peek."),i.a.createElement("li",null,"The operation sequence for each job is listed under Jobs menu")),"We have ",this.props.machines.length," machines for different operations, and various different types of products we need to produce.",i.a.createElement("ol",null,this.props.machines.map((function(e,t){return i.a.createElement("li",{key:e.id},"Machine Id ",e.id," - ",e.name)}))),"This factory produces ",this.props.jobs.length," different types of water bottles, and each water bottling operation must be run in the following order:",i.a.createElement("ol",null,this.props.jobs.map((function(e,t){return i.a.createElement("li",{key:e.id},i.a.createElement("span",{style:{backgroundColor:"".concat(T(t))}},"Job id ",e.id," - ",e.name," "),i.a.createElement("ol",null,e.operations.map((function(e,t){var a=e.machineAndTimes.map((function(e){return"| ".concat(e[1]," Seconds if run on Machine ").concat(e[0]," |")}));return i.a.createElement("li",{key:t},e.operationName,"- ",a)}))))}))),"Algorithm that runs in the background finds the most optimal way of running all the jobs in the given order. The Chart shows the order in which each job must run on each machine to complete all bottling activities in the most efficient manner. Watch the chart change as the algorithm finds more and more efficient way to run the factory."))}}]),a}(i.a.Component),Y=a(24),z=a(15),V=function(e){Object(p.a)(a,e);var t=Object(d.a)(a);function a(e){var n;return Object(u.a)(this,a),(n=t.call(this,e)).handleNavBarClick=function(e){n.setState({activeMenu:e}),console.log(e)},n.createMachine=function(){var e=Object(m.a)(l.a.mark((function e(t){return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t.id=n.state.machines.length+1,n.setState({machines:[].concat(Object(s.a)(n.state.machines),[t])});case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),n.updateMachine=function(e){n.setState({machines:n.state.machines.map((function(t){return t.id===e.id?e:t}))})},n.deleteMachine=function(e){n.setState({machines:n.state.machines.filter((function(t){return t.id!==e.id}))})},n.createCategory=function(e){e.id=n.state.categories.reduce((function(e,t){return t.id+1}),1),n.setState({categories:[].concat(Object(s.a)(n.state.categories),[e])})},n.updateCategory=function(e){n.setState({categories:n.state.categories.map((function(t){return t.id===e.id?e:t}))})},n.deleteCategory=function(e){console.log("deleting ",e),n.setState({categories:n.state.categories.filter((function(t){return t.id!==e.id}))})},n.createJob=function(e){console.log("new job ",e),e.id=n.state.jobs.reduce((function(e,t){return t.id>=e?t.id+1:e}),1),n.setState({jobs:[].concat(Object(s.a)(n.state.jobs),[e])})},n.updateJob=function(e){n.setState({jobs:n.state.jobs.map((function(t){return t.id===e.id?e:t}))})},n.deleteJob=function(e){n.setState({jobs:n.state.jobs.filter((function(t){return t.id!==e.id}))})},n.state={machines:[],categories:[],jobs:[],best_schedule:[],makeSpan:150},n}return Object(h.a)(a,[{key:"componentDidMount",value:function(){var e=JSON.parse(localStorage.getItem("machines")||'[{"name":"Bottle Expansion Mold Machine","categories":[],"id":1},{"name":"Water Cleaning Machine","categories":[],"id":2},{"name":"Water Filling Machine","categories":[],"id":3},{"name":"Bottle Capping Machine","categories":[],"id":4},{"name":"Bottle Labeling Machine","categories":[],"id":5},{"name":"Bottle Expansion Mold Machine 2","categories":[],"id":6}]'),t=JSON.parse(localStorage.getItem("categories")||"[]"),a=JSON.parse(localStorage.getItem("jobs")||'[{"id":1,"name":"Spring Water 16oz","operations":[{"id":1,"operationName":"Bottle Expansion","machineAndTimes":[[1,"10"],["6","20"]]},{"id":2,"operationName":"Water Purifying","machineAndTimes":[["2","10"]]},{"id":3,"operationName":"Water Filling","machineAndTimes":[["3","10"]]},{"id":4,"operationName":"Bottle Capping","machineAndTimes":[["4","10"]]},{"id":5,"operationName":"Bottle Labeling","machineAndTimes":[["5","8"]]},{"id":6,"operationName":"Bottle Labeling 2","machineAndTimes":[["5","10"]]},{"id":7,"operationName":"Bottle Labeling 3","machineAndTimes":[["5","10"]]}]},{"id":2,"name":"Distilled Water 16oz","operations":[{"id":1,"operationName":"Bottle Expansion","machineAndTimes":[[1,"50"],["6","30"]]},{"id":2,"operationName":"Water Purifying","machineAndTimes":[["2","15"]]},{"id":3,"operationName":"Water Filling","machineAndTimes":[["3","10"]]},{"id":4,"operationName":"Bottle Capping","machineAndTimes":[["4","10"]]}]},{"id":3,"name":"Distilled Water 32oz","operations":[{"id":1,"operationName":"Bottle Expansion ","machineAndTimes":[[1,"30"],["6","50"]]},{"id":2,"operationName":"Water Purifying","machineAndTimes":[["2","12"]]},{"id":3,"operationName":"Water Filling","machineAndTimes":[["3","20"]]},{"id":4,"operationName":"Bottle Capping","machineAndTimes":[["4","10"]]},{"id":5,"operationName":"Bottle Labeling","machineAndTimes":[["5","16"]]}]},{"id":4,"name":"Bottle Water 32oz","operations":[{"id":1,"operationName":"Bottle Expansion ","machineAndTimes":[[1,"15"],["6","20"]]},{"id":2,"operationName":"Water Purifying","machineAndTimes":[["2","30"]]},{"id":3,"operationName":"Water Filling","machineAndTimes":[["3","20"]]},{"id":4,"operationName":"Bottle Capping","machineAndTimes":[["4","10"]]},{"id":5,"operationName":"Bottle Labeling","machineAndTimes":[["5","10"]]}]}]');this.setState({machines:e,categories:t,jobs:a})}},{key:"componentDidUpdate",value:function(){localStorage.setItem("machines",JSON.stringify(this.state.machines)),localStorage.setItem("categories",JSON.stringify(this.state.categories)),localStorage.setItem("jobs",JSON.stringify(this.state.jobs))}},{key:"render",value:function(){return i.a.createElement(Y.a,{basename:"/job-shop-scheduling-problem-javascript"},i.a.createElement("nav",{className:"factory-navbar d-flex justify-content-between"},i.a.createElement("div",{className:"ml-2 navbar-brand text-white"},"Water Bottling Plant Makespan Optimization"),i.a.createElement("ul",{className:"d-flex mr-5"},i.a.createElement(Y.b,{to:"machines"},i.a.createElement("li",{className:"factory-navbar__menu-item"},"Machines")),i.a.createElement(Y.b,{to:"jobs"},i.a.createElement("li",{className:"factory-navbar__menu-item"},"Jobs")),i.a.createElement(Y.b,{to:"/",exact:!0},i.a.createElement("li",{className:"factory-navbar__menu-item"},"Solve")))),i.a.createElement(z.c,null,i.a.createElement(z.a,{path:"/machines",exact:!0},i.a.createElement("div",{className:"container-fluid"},i.a.createElement("div",{className:"row"},i.a.createElement("div",{className:"col-sm-8"},i.a.createElement(y,{createMachine:this.createMachine,updateMachine:this.updateMachine,deleteMachine:this.deleteMachine,machines:this.state.machines,categories:this.state.categories})),i.a.createElement("div",{className:"col-sm-4"},i.a.createElement(C,{categories:this.state.categories,machines:this.state.machines,createCategory:this.createCategory,updateCategory:this.updateCategory,deleteCategory:this.deleteCategory}))))),i.a.createElement(z.a,{path:"/jobs",exact:!0},i.a.createElement(k,{createJob:this.createJob,updateJob:this.updateJob,deleteJob:this.deleteJob,jobs:this.state.jobs,machines:this.state.machines})),i.a.createElement(z.a,{path:"/parameters",exact:!0},i.a.createElement(w,null)),i.a.createElement(z.a,{path:"",exact:!0},i.a.createElement(G,{jobs:this.state.jobs,machines:this.state.machines}))))}}]),a}(i.a.Component),q=Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));function K(e,t){navigator.serviceWorker.register(e).then((function(e){e.onupdatefound=function(){var a=e.installing;null!=a&&(a.onstatechange=function(){"installed"===a.state&&(navigator.serviceWorker.controller?(console.log("New content is available and will be used when all tabs for this page are closed. See https://bit.ly/CRA-PWA."),t&&t.onUpdate&&t.onUpdate(e)):(console.log("Content is cached for offline use."),t&&t.onSuccess&&t.onSuccess(e)))})}})).catch((function(e){console.error("Error during service worker registration:",e)}))}o.a.render(i.a.createElement(V,null),document.getElementById("root")),function(e){if("serviceWorker"in navigator){if(new URL("/job-shop-scheduling-problem-javascript",window.location.href).origin!==window.location.origin)return;window.addEventListener("load",(function(){var t="".concat("/job-shop-scheduling-problem-javascript","/service-worker.js");q?(!function(e,t){fetch(e).then((function(a){var n=a.headers.get("content-type");404===a.status||null!=n&&-1===n.indexOf("javascript")?navigator.serviceWorker.ready.then((function(e){e.unregister().then((function(){window.location.reload()}))})):K(e,t)})).catch((function(){console.log("No internet connection found. App is running in offline mode.")}))}(t,e),navigator.serviceWorker.ready.then((function(){console.log("This web app is being served cache-first by a service worker. To learn more, visit https://bit.ly/CRA-PWA")}))):K(t,e)}))}}()}},[[60,1,2]]]);
//# sourceMappingURL=main.5ae56776.chunk.js.map