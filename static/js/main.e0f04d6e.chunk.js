(this["webpackJsonpjssp-frontend"]=this["webpackJsonpjssp-frontend"]||[]).push([[0],{23:function(e,t,a){},33:function(e,t,a){e.exports=a(60)},38:function(e,t,a){},60:function(e,t,a){"use strict";a.r(t);var n=a(1),o=a.n(n),l=a(30),r=a.n(l),i=(a(38),a(31)),s=a(9),c=a(3),m=a(4),u=a(7),h=a(5),p=a(8);a(23);var d=function(e){for(var t="".concat(e,"color"),a=0,n=0;n<t.length;n++)a=t.charCodeAt(n)+((a<<5)-a);var o="#";for(n=0;n<3;n++){o+=("00"+(a>>8*n&255).toString(16)).substr(-2)}return o},g=function(e){function t(e){return Object(c.a)(this,t),Object(u.a)(this,Object(h.a)(t).call(this,e))}return Object(p.a)(t,e),Object(m.a)(t,[{key:"randColor",value:function(){return Math.floor(180*Math.random())}},{key:"render",value:function(){for(var e=[],t=0;t<this.props.schedule.length;t++)if(t%3===0){var a=this.props.schedule[t],n=this.props.schedule[t+1],l=this.props.schedule[t+2],r=100*(l-n)/this.props.maxTime,i=100*n/this.props.maxTime,s={width:"".concat(r,"%"),height:"20px",backgroundColor:"".concat(d(a)),position:"absolute",left:"".concat(i,"%"),transition:"all 1s linear"},c=o.a.createElement("div",{id:"key-".concat(this.props.index,"-").concat(a),className:"job-".concat(a),style:s,"data-start":n,"data-end":l,"data-jobid":a},"Job-",a);e.push(c)}var m={position:"relative",display:"flex",top:"".concat(25*this.props.index,"px")};return o.a.createElement("div",{style:m},e)}}]),t}(o.a.Component),f=function(e){function t(){return Object(c.a)(this,t),Object(u.a)(this,Object(h.a)(t).apply(this,arguments))}return Object(p.a)(t,e),Object(m.a)(t,[{key:"render",value:function(){for(var e={position:"relative",top:"".concat(25*this.props.index,"px")},t=[],a=10*(this.props.maxTime/10+1),n=0;n<a;n++){var l=100*n/this.props.maxTime,r={left:"".concat(l,"%"),transition:"all 1s linear",position:"absolute"};if(n%10===0){var i=o.a.createElement("span",{style:r},o.a.createElement("div",null,"|"),o.a.createElement("div",null,n));t.push(i)}}return o.a.createElement("div",{style:e},t)}}]),t}(o.a.Component),b=["Bottle Expansion Mold","Water Cleaning/ Purifying","Water Filling","Bottle Capping","Bottle Labeling"],E=function(e){function t(){return Object(c.a)(this,t),Object(u.a)(this,Object(h.a)(t).apply(this,arguments))}return Object(p.a)(t,e),Object(m.a)(t,[{key:"render",value:function(){console.log(this.props);var e=this.props.schedule.map((function(e){return e[e.length-1]}));console.log(e);var t=Math.max.apply(Math,Object(s.a)(e));return o.a.createElement(o.a.Fragment,null,o.a.createElement("div",{className:"ganttChartWithY"},o.a.createElement("div",{className:"ganttChartYAxis"},this.props.schedule.map((function(e,t){var a=b[t];return o.a.createElement("span",{className:"yAxisTick"},"".concat(a," Machine"))}))),o.a.createElement("div",{className:"ganttChartData"},this.props.schedule.map((function(e,a){return o.a.createElement(g,{schedule:e,maxTime:t,index:a})})),o.a.createElement(f,{index:this.props.schedule.length,maxTime:t}))))}}]),t}(o.a.Component),v=function(){var e=function(e){var t=this;this.schedule=e,this.getMakeSpan=function(){var e=t.schedule.map((function(e){return e.length&&0!==e.length?e[e.length-1]:0})),a=-1/0;return e.forEach((function(e){e>a&&(a=e)})),a}};function t(t){var a=this;this.jssp1d=t,this.JSSP1dToGantt=function(t){for(var n=[],o=0;o<t.numMachines;o++)n.push([]);var l=new Array(t.numJobs).fill(0);return a.jssp1d.forEach((function(e){var a=t.jobs[e].splice(0,2),o=a[0],r=a[1],i=0===n[o].length?0:n[o][n[o].length-1],s=l[e],c=Math.max(s,i);l[e]=c+r;[e,c+1,c+r].forEach((function(e){return n[o].push(e)}))})),new e(n)}}function a(e,a){for(var n=[],o=0;o<a;o++)for(var l=0;l<e;l++)n.push(o);console.log("done creating jobs"),console.log(n);var r=new t(function(e){for(var t,a,n=e.length;0!==n;)a=Math.floor(Math.random()*n),t=e[n-=1],e[n]=e[a],e[a]=t;return e}(n));return console.log(r),r}function n(e){for(var t=(new Date).getTime();t+e>=(new Date).getTime(););}onmessage=function(e){console.log("this inside onmessage"),console.log(this),console.log("Message received from main script"),console.log("message",e);var t=e.data,o=t.problem,l=t.algorithmRepetition,r=t.algorithmMaxTimeSecs;console.log(o,r),function(e,t,o){console.log("inside run optimization , this is "),console.log(this),console.log(a&&"generate Random 1d is available");for(var l=1/0,r=(new Date).getTime()+1e3*o,i=[],s=0;s<t;s++){if(s%5===0&&(new Date).getTime()>r){console.log("Ran for too long already");break}if(s%100==0&&(new Date).getTime()>r){console.log("Ending because of time limit"),console.log("Ran times : ",s);break}var c=a(e.numMachines,e.numJobs),m=Object.assign({},e);m.jobs=JSON.parse(JSON.stringify(e.jobs));var u=c.JSSP1dToGantt(m),h=u.getMakeSpan();if(console.log("adding to newmakespan from worer"),i.push(h),s%1===0){var p={type:"iterationCount",iteration:s+1,newMakeSpan:i};this.postMessage(p),n(200),i.length=0}if(h<l){l=h,console.log("Found Better",u),console.log("New Make Span at index ",s,h),this.postMessage("Got New MakeSpan");var d={type:"newSchedule",schedule:u.schedule,makeSpan:l,minMakeSpanDetectedIteration:s};this.postMessage(d),n(1e3)}}}(o,l,r);var i="Received from main: "+e.data;console.log("Posting message back to main script"),this.postMessage(i)}}.toString();v=v.substring(v.indexOf("{")+1,v.lastIndexOf("}"));var S=new Blob([v],{type:"application/javascript"}),k=URL.createObjectURL(S);a(39);function w(e){return o.a.createElement("nav",{class:"navbar navbar-expand-lg navbar-dark bg-primary"},o.a.createElement("a",{class:"navbar-brand",href:"/"},"Job Shop Problem Demo"),o.a.createElement("button",{class:"navbar-toggler",type:"button","data-toggle":"collapse","data-target":"#navbarSupportedContent","aria-controls":"navbarSupportedContent","aria-expanded":"false","aria-label":"Toggle navigation"},o.a.createElement("span",{class:"navbar-toggler-icon"})),o.a.createElement("div",{class:"collapse navbar-collapse",id:"navbarSupportedContent"},o.a.createElement("ul",{class:"navbar-nav mr-auto"},o.a.createElement("li",{class:"nav-item active"},o.a.createElement("a",{class:"nav-link",href:"/"},"Water Bottle Plant Example ",o.a.createElement("span",{class:"sr-only"},"(current)"))))))}a(40);var y=a(11),M=function(e){function t(){return Object(c.a)(this,t),Object(u.a)(this,Object(h.a)(t).apply(this,arguments))}return Object(p.a)(t,e),Object(m.a)(t,[{key:"render",value:function(){console.log(this.props);var e=this.props.data.map((function(e,t){return{x:t,y:e}}));return o.a.createElement("div",{className:"App"},o.a.createElement("div",null,o.a.createElement(y.e,{height:this.props.height||300,width:this.props.width||300},o.a.createElement(y.b,{data:e}),o.a.createElement(y.d,{title:"Number of Iterations"}),o.a.createElement(y.f,{title:"MakeSpan"}),o.a.createElement(y.c,null),o.a.createElement(y.a,null))))}}]),t}(n.Component),x=new function(e,t){this.numJobs=e,this.numMachines=t,this.jobs=[]}(4,5);x.jobs=[[0,10,1,10,2,10,3,10,4,8],[0,50,1,15,2,10,3,10,4,16],[0,30,1,12,2,20,3,10,4,16],[0,15,1,30,2,20,3,10,4,10]];var j=function(e){function t(e){var a;return Object(c.a)(this,t),(a=Object(u.a)(this,Object(h.a)(t).call(this,e))).startJobShopWorker=function(){var e=new Worker(k);e.addEventListener("message",(function(e){console.log("Received response:"),console.log(e.data),e.data&&"iterationCount"===e.data.type?(console.log("About to concate makeSpan history array"),a.setState({iterations:e.data.iteration,makeSpanHistory:[].concat(Object(s.a)(a.state.makeSpanHistory),Object(s.a)(e.data.newMakeSpan))})):e.data&&"newSchedule"===e.data.type?(console.log("New Schedule ".concat(e.data.schedule)),a.setState({schedule:e.data.schedule,makeSpan:e.data.makeSpan,minMakeSpanDetectedIteration:e.data.minMakeSpanDetectedIteration})):console.log("generic Message ",e.data)}),!1),e.postMessage({algorithmRepetition:a.state.maxAlgorithmRepetition,problem:x,algorithmMaxTimeSecs:a.state.algorithmMaxTimeSecs}),a.setState({workerInstance:e})},a.handleChange=function(e){a.setState(Object(i.a)({},e.target.name,e.target.value))},a.handleRestartJobShopWorkerButton=function(e){e.preventDefault(),console.log("restarting this puppy."),console.log(e),a.state.workerInstance.terminate(),a.setState({schedule:[[],[]],makeSpan:1/0,minMakeSpanDetectedIteration:0,iterations:0,makeSpanHistory:[]},a.startJobShopWorker())},a.handleStopWorker=function(e){a.state.workerInstance.terminate()},a.state={schedule:[[],[]],makeSpan:1/0,minMakeSpanDetectedIteration:0,iterations:0,workerInstance:new Worker(k),makeSpanHistory:[],maxAlgorithmRepetition:50,algorithmMaxTimeSecs:30},a}return Object(p.a)(t,e),Object(m.a)(t,[{key:"componentDidMount",value:function(){this.startJobShopWorker()}},{key:"render",value:function(){console.log("Render function re-running",this.state.schedule);var e=.9*window.innerWidth;return o.a.createElement("div",{className:"App"},o.a.createElement(w,null),o.a.createElement("h3",null,"Water Bottling Plant - MakeSpan Optimization"),o.a.createElement("p",null,o.a.createElement("strong",null,"Number of Simulations Performed:")," ",this.state.iterations,"  |",o.a.createElement("strong",null,"Minimum MakeSpan detected:")," ",this.state.makeSpan," | ",o.a.createElement("strong",null,"Min detected after iteration :")," ",this.state.minMakeSpanDetectedIteration),o.a.createElement("h6",null,"Plot of makespan for each different simulation when using random Algorithm"),o.a.createElement(M,{data:this.state.makeSpanHistory,width:e}),o.a.createElement("hr",null),o.a.createElement("h6",null,"Schedule with the least makespan"),o.a.createElement(E,{schedule:this.state.schedule}),o.a.createElement("div",{className:"explanation"},o.a.createElement("p",null,"The Chart above shows the order in which each operation in a water bottling plant must run on each machine to complete all bottling activities in the most efficient manner. Watch the chart change as the algorithm finds more and more efficient way to run the factory over time. Simulation is slowed down for demonstration purpose. Run the simulations with different settings below:"),o.a.createElement("form",{onSubmit:this.handleRestartJobShopWorkerButton},o.a.createElement("div",{class:"form-row p-2 m-2"},o.a.createElement("div",{class:"col"},o.a.createElement("label",{for:"inputEmail4"}," Max number of iterations"),o.a.createElement("input",{type:"number",name:"maxAlgorithmRepetition",onChange:this.handleChange,value:this.state.maxAlgorithmRepetition,class:"form-control",placeholder:"Max Seconds to run simulation"})),o.a.createElement("div",{class:"col"},o.a.createElement("label",{for:"inputEmail4"},"Max Seconds to run simulation"),o.a.createElement("input",{type:"number",name:"algorithmMaxTimeSecs",onChange:this.handleChange,value:this.state.algorithmMaxTimeSecs,class:"form-control",placeholder:"Max number of iterations"}))),o.a.createElement("div",{class:"form-row"},o.a.createElement("div",{class:"col"},o.a.createElement("input",{type:"submit",value:"Restart Simulation"}),o.a.createElement("button",{className:"ml-2",onClick:this.handleStopWorker},"Stop Simulation")))),o.a.createElement("hr",null),o.a.createElement("h3",null,"Explanation"),"In this demo, we are trying to optimize how to run a water bottling plant. We have 5 machines for different operations, and various different types of products we need to produce.",o.a.createElement("ol",null,o.a.createElement("li",null,"Machine 0 - Bottle Expansion Molding"),o.a.createElement("li",null,"Machine 1 - Water Cleaning or purifying Machine "),o.a.createElement("li",null,"Machine 2 - Pouring water / Filling Process "),o.a.createElement("li",null,"Machine 3 - Capping"),o.a.createElement("li",null,"Machine 4 - Labelling")),"This factory produces 4 different types of water bottles, and each water bottling operation must be run in the following order:",o.a.createElement("ol",null,o.a.createElement("li",null,o.a.createElement("span",{style:{backgroundColor:"".concat(d(0))}},"Job 0 - Spring Water 16oz "),o.a.createElement("ol",null,o.a.createElement("li",null,"Bottle Expansion - 10 seconds"),o.a.createElement("li",null,"Water Purifying - 30 seconds"),o.a.createElement("li",null,"Water Filling - 10 seconds"),o.a.createElement("li",null,"Bottle Capping - 10 seconds"),o.a.createElement("li",null,"Bottle Labeling - 8 seconds"))),o.a.createElement("li",null,o.a.createElement("span",{style:{backgroundColor:"".concat(d(1))}},"Job 1 - Distilled Water 16 oz"),o.a.createElement("ol",null,o.a.createElement("li",null,"Bottle Expansion - 50 seconds"),o.a.createElement("li",null,"Water Purifying - 60 seconds"),o.a.createElement("li",null,"Water Filling - 10 seconds"),o.a.createElement("li",null,"Bottle Capping - 10 seconds"),o.a.createElement("li",null,"Bottle Labeling - 16 seconds"))),o.a.createElement("li",null,o.a.createElement("span",{style:{backgroundColor:"".concat(d(2))}},"Job 2 - Distilled Water 32 oz"),o.a.createElement("ol",null,o.a.createElement("li",null,"Bottle Expansion - 30 seconds"),o.a.createElement("li",null,"Water Purifying - 90 seconds"),o.a.createElement("li",null,"Water Filling - 20 seconds"),o.a.createElement("li",null,"Bottle Capping - 10 seconds"),o.a.createElement("li",null,"Bottle Labeling - 16 seconds"))),o.a.createElement("li",null,o.a.createElement("span",{style:{backgroundColor:"".concat(d(3))}},"Job 3 - Bottoled Water 32 oz"),o.a.createElement("ol",null,o.a.createElement("li",null,"Bottle Expansion - 15 seconds"),o.a.createElement("li",null,"Water Purifying - 90 seconds"),o.a.createElement("li",null,"Water Filling - 20 seconds"),o.a.createElement("li",null,"Bottle Capping - 10 seconds"),o.a.createElement("li",null,"Bottle Labeling - 10 seconds")))),"Algorithm that runs in the background finds the most optimal way of running all the jobs in the given order. The Chart shows the order in which each job must run on each machine to complete all bottling activities in the most efficient manner. Watch the chart change as the algorithm finds more and more efficient way to run the factory."))}}]),t}(o.a.Component);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));r.a.render(o.a.createElement(j,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()}))}},[[33,1,2]]]);
//# sourceMappingURL=main.e0f04d6e.chunk.js.map