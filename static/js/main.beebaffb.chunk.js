(this["webpackJsonpjssp-frontend"]=this["webpackJsonpjssp-frontend"]||[]).push([[0],{23:function(e,t,a){},33:function(e,t,a){e.exports=a(60)},38:function(e,t,a){},60:function(e,t,a){"use strict";a.r(t);var n=a(1),l=a.n(n),o=a(30),r=a.n(o),i=(a(38),a(31)),s=a(9),c=a(3),m=a(4),u=a(7),h=a(5),p=a(8);a(23);var d=function(e){for(var t="".concat(e,"color"),a=0,n=0;n<t.length;n++)a=t.charCodeAt(n)+((a<<5)-a);var l="#";for(n=0;n<3;n++){l+=("00"+(a>>8*n&255).toString(16)).substr(-2)}return l},g=function(e){function t(e){return Object(c.a)(this,t),Object(u.a)(this,Object(h.a)(t).call(this,e))}return Object(p.a)(t,e),Object(m.a)(t,[{key:"randColor",value:function(){return Math.floor(180*Math.random())}},{key:"render",value:function(){for(var e=[],t=0;t<this.props.schedule.length;t++)if(t%3===0){var a=this.props.schedule[t],n=this.props.schedule[t+1],o=this.props.schedule[t+2],r=100*(o-n)/this.props.maxTime,i=100*n/this.props.maxTime,s={width:"".concat(r,"%"),height:"20px",backgroundColor:"".concat(d(a)),position:"absolute",left:"".concat(i,"%"),transition:"all 1s linear"},c=l.a.createElement("div",{id:"key-".concat(this.props.index,"-").concat(a),className:"job-".concat(a),style:s,"data-start":n,"data-end":o,"data-jobid":a},"Job-",a);e.push(c)}var m={position:"relative",display:"flex",top:"".concat(25*this.props.index,"px")};return l.a.createElement("div",{style:m},e)}}]),t}(l.a.Component),f=function(e){function t(){return Object(c.a)(this,t),Object(u.a)(this,Object(h.a)(t).apply(this,arguments))}return Object(p.a)(t,e),Object(m.a)(t,[{key:"render",value:function(){for(var e={position:"relative",top:"".concat(25*this.props.index,"px")},t=[],a=10*(this.props.maxTime/10+1),n=0;n<a;n++){var o=100*n/this.props.maxTime,r={left:"".concat(o,"%"),transition:"all 1s linear",position:"absolute"};if(n%10===0){var i=l.a.createElement("span",{style:r},l.a.createElement("div",null,"|"),l.a.createElement("div",null,n));t.push(i)}}return l.a.createElement("div",{style:e},t)}}]),t}(l.a.Component),b=["Bottle Expansion Mold","Water Cleaning/ Purifying","Water Filling","Bottle Capping","Bottle Labeling"],E=function(e){function t(){return Object(c.a)(this,t),Object(u.a)(this,Object(h.a)(t).apply(this,arguments))}return Object(p.a)(t,e),Object(m.a)(t,[{key:"render",value:function(){console.log(this.props);var e=this.props.schedule.map((function(e){return e[e.length-1]}));console.log(e);var t=Math.max.apply(Math,Object(s.a)(e));return l.a.createElement("div",{className:"ganttChartWithY"},l.a.createElement("div",{className:"ganttChartYAxis"},this.props.schedule.map((function(e,t){var a=b[t];return l.a.createElement("span",{className:"yAxisTick"},"".concat(a," Machine"))}))),l.a.createElement("div",{className:"ganttChartData"},this.props.schedule.map((function(e,a){return l.a.createElement(g,{schedule:e,maxTime:t,index:a})})),l.a.createElement(f,{index:this.props.schedule.length,maxTime:t})))}}]),t}(l.a.Component),v=function(){var e=function(e){var t=this;this.schedule=e,this.getMakeSpan=function(){var e=t.schedule.map((function(e){return e.length&&0!==e.length?e[e.length-1]:0})),a=-1/0;return e.forEach((function(e){e>a&&(a=e)})),a}};function t(t){var a=this;this.jssp1d=t,this.JSSP1dToGantt=function(t){for(var n=[],l=0;l<t.numMachines;l++)n.push([]);var o=new Array(t.numJobs).fill(0);return a.jssp1d.forEach((function(e){var a=t.jobs[e].splice(0,2),l=a[0],r=a[1],i=0===n[l].length?0:n[l][n[l].length-1],s=o[e],c=Math.max(s,i);o[e]=c+r;[e,c+1,c+r].forEach((function(e){return n[l].push(e)}))})),new e(n)}}function a(e,a,n,l){if(n){return function(){for(var e=Math.floor(Math.random()*n.length),t=Math.floor(Math.random()*n.length);n[e]===n[t];)t=Math.floor(Math.random()*n.length);var a=n[e];n[e]=n[t],n[t]=a}(),new t(n)}for(var o=[],r=0;r<a;r++)for(var i=0;i<e;i++)o.push(r);console.log("done creating jobs"),console.log(o);var s=new t(function(e){for(var t,a,n=e.length;0!==n;)a=Math.floor(Math.random()*n),t=e[n-=1],e[n]=e[a],e[a]=t;return e}(o));return console.log(s),s}function n(e){for(var t=(new Date).getTime();t+e>=(new Date).getTime(););}onmessage=function(e){console.log("this inside onmessage"),console.log(this),console.log("Message received from main script"),console.log("message",e);var t=e.data,l=t.problem,o=t.algorithmRepetition,r=t.algorithmMaxTimeSecs,i=t.algorithmType;console.log(l,r),function(e,t,l,o){console.log("inside run optimization , this is "),console.log(this),console.log(a&&"generate Random 1d is available");for(var r,i=1/0,s=(new Date).getTime()+1e3*l,c=[],m=0;m<t;m++){if(m%5===0&&(new Date).getTime()>s){console.log("Ran for too long already");break}if(m%100==0&&(new Date).getTime()>s){console.log("Ending because of time limit"),console.log("Ran times : ",m);break}var u=a(e.numMachines,e.numJobs,"hillClimbing"===o?r&&r.jssp1d:null),h=Object.assign({},e);h.jobs=JSON.parse(JSON.stringify(e.jobs));var p=u.JSSP1dToGantt(h),d=p.getMakeSpan();if(console.log("adding to newmakespan from worer"),c.push(d),m%1===0){var g={type:"iterationCount",iteration:m+1,newMakeSpan:c};this.postMessage(g),n(200),c.length=0}if(d<i){i=d,r=u,console.log("Found Better",p),console.log("New Make Span at index ",m,d),this.postMessage("Got New MakeSpan");var f={type:"newSchedule",schedule:p.schedule,makeSpan:i,minMakeSpanDetectedIteration:m};this.postMessage(f),n(1e3)}}}(l,o,r,i);var s="Received from main: "+e.data;console.log("Posting message back to main script"),this.postMessage(s)}}.toString();v=v.substring(v.indexOf("{")+1,v.lastIndexOf("}"));var k=new Blob([v],{type:"application/javascript"}),y=URL.createObjectURL(k);a(39);function w(e){return l.a.createElement("nav",{className:"navbar navbar-expand-lg navbar-dark",style:{backgroundColor:"#34495e"}},l.a.createElement("a",{className:"navbar-brand",href:"/"},"Water Bottle Plant Makespan Optimization"),l.a.createElement("button",{className:"navbar-toggler",type:"button","data-toggle":"collapse","data-target":"#navbarSupportedContent","aria-controls":"navbarSupportedContent","aria-expanded":"false","aria-label":"Toggle navigation"},l.a.createElement("span",{className:"navbar-toggler-icon"})),l.a.createElement("div",{className:"collapse navbar-collapse",id:"navbarSupportedContent"},l.a.createElement("ul",{className:"navbar-nav mr-auto"},e.children)))}a(40);var S=a(11),M=function(e){function t(){return Object(c.a)(this,t),Object(u.a)(this,Object(h.a)(t).apply(this,arguments))}return Object(p.a)(t,e),Object(m.a)(t,[{key:"render",value:function(){console.log(this.props);var e=this.props.data.map((function(e,t){return{x:t,y:e}}));return l.a.createElement("div",{className:"twodplot"},l.a.createElement("div",null,l.a.createElement(S.e,{height:this.props.height||300,width:this.props.width||300},l.a.createElement(S.b,{data:e}),l.a.createElement(S.d,{title:"Number of Iterations"}),l.a.createElement(S.f,{title:"MakeSpan"}),l.a.createElement(S.c,null),l.a.createElement(S.a,null))))}}]),t}(n.Component),j=new function(e,t){this.numJobs=e,this.numMachines=t,this.jobs=[]}(4,5);j.jobs=[[0,10,1,10,2,10,3,10,4,8],[0,50,1,15,2,10,3,10,4,16],[0,30,1,12,2,20,3,10,4,16],[0,15,1,30,2,20,3,10,4,10]];var x=function(e){function t(e){var a;return Object(c.a)(this,t),(a=Object(u.a)(this,Object(h.a)(t).call(this,e))).startJobShopWorker=function(){var e=new Worker(y);e.addEventListener("message",(function(e){e.data&&"iterationCount"===e.data.type?a.setState({iterations:e.data.iteration,makeSpanHistory:[].concat(Object(s.a)(a.state.makeSpanHistory),Object(s.a)(e.data.newMakeSpan))}):e.data&&"newSchedule"===e.data.type?a.setState({schedule:e.data.schedule,makeSpan:e.data.makeSpan,minMakeSpanDetectedIteration:e.data.minMakeSpanDetectedIteration}):console.log("generic Message ",e.data)}),!1),e.postMessage({algorithmRepetition:a.state.maxAlgorithmRepetition,problem:j,algorithmMaxTimeSecs:a.state.algorithmMaxTimeSecs,algorithmType:a.state.algorithmType}),a.setState({workerInstance:e})},a.handleChange=function(e){a.setState(Object(i.a)({},e.target.name,e.target.value))},a.handleRestartJobShopWorkerButton=function(e){e.preventDefault(),a.state.workerInstance.terminate(),a.setState({schedule:[[],[]],makeSpan:1/0,minMakeSpanDetectedIteration:0,iterations:0,makeSpanHistory:[]},a.startJobShopWorker())},a.handleStopWorker=function(e){a.state.workerInstance.terminate()},a.state={schedule:[[],[]],makeSpan:1/0,minMakeSpanDetectedIteration:0,iterations:0,workerInstance:new Worker(y),makeSpanHistory:[],maxAlgorithmRepetition:50,algorithmMaxTimeSecs:30,algorithmType:"hillClimbing"},a}return Object(p.a)(t,e),Object(m.a)(t,[{key:"componentDidMount",value:function(){this.startJobShopWorker()}},{key:"render",value:function(){var e=window.innerWidth-60;return l.a.createElement("div",{className:"App"},l.a.createElement(w,null,l.a.createElement("li",{class:"nav-item"},l.a.createElement("select",{className:"form-control ml-2",name:"algorithmType",onChange:this.handleChange,value:this.state.algorithmType},l.a.createElement("option",{value:"random"},"Random Search"),l.a.createElement("option",{value:"hillClimbing"},"Hill Climbing Search"))),l.a.createElement("li",{class:"nav-item ml-2"},l.a.createElement("button",{className:"btn btn-outline-danger ml-2",onClick:this.handleStopWorker}," Stop ")),l.a.createElement("li",{class:"nav-item ml-2"},l.a.createElement("button",{className:"btn btn-outline-success",onClick:this.handleRestartJobShopWorkerButton},"  Restart with new settings "))),l.a.createElement("div",{className:"container"},l.a.createElement("div",{className:"row"},l.a.createElement("div",{className:"col"},l.a.createElement("table",{className:" table table-sm mt-2"},l.a.createElement("thead",null,l.a.createElement("tr",null,l.a.createElement("th",{colSpan:2},"Simulation Parameters "))),l.a.createElement("tbody",null,l.a.createElement("tr",null,l.a.createElement("td",null,"Number of Simulations"),l.a.createElement("td",null,this.state.iterations," ")),l.a.createElement("tr",null,l.a.createElement("td",null,"Minimal Makespan Detected"),l.a.createElement("td",null,this.state.makeSpan)),l.a.createElement("tr",null,l.a.createElement("td",null,"Min detected after iteration"),l.a.createElement("td",null,this.state.minMakeSpanDetectedIteration))))),l.a.createElement("div",{className:"col"},l.a.createElement("table",{className:"table table-sm mt-2"},l.a.createElement("thead",null,l.a.createElement("tr",null,l.a.createElement("th",{colSpan:2},"Termination Criteria"))),l.a.createElement("tbody",null,l.a.createElement("tr",null,l.a.createElement("td",null,"Number of Simuations"),l.a.createElement("td",null,l.a.createElement("input",{type:"number",style:{width:"4em"},name:"maxAlgorithmRepetition",onChange:this.handleChange,value:this.state.maxAlgorithmRepetition}))),l.a.createElement("tr",null,l.a.createElement("td",null,"Maximum Time in seconds"),l.a.createElement("td",null,l.a.createElement("input",{type:"number",style:{width:"4em"},name:"algorithmMaxTimeSecs",onChange:this.handleChange,value:this.state.algorithmMaxTimeSecs,class:"form-controll",placeholder:"Max number of iterations"})))))))),l.a.createElement("div",{style:{marginTop:"10px"}},l.a.createElement("h6",null,"Plot of makespan during each different simulation"),l.a.createElement(M,{data:this.state.makeSpanHistory,width:e})),l.a.createElement("hr",null),l.a.createElement("h6",null,"Schedule with the least makespan"),l.a.createElement(E,{schedule:this.state.schedule}),l.a.createElement("div",{className:"explanation"},l.a.createElement("p",null,"The Chart above shows the order in which each operation in a water bottling plant must run on each machine to complete all bottling activities in the most efficient manner. Watch the chart change as the algorithm finds more and more efficient way to run the factory over time. Simulation is slowed down for demonstration purpose. Run the simulations with different settings below:"),l.a.createElement("hr",null),l.a.createElement("h3",null,"Explanation"),"In this demo, we are trying to optimize how to run a water bottling plant. We have 5 machines for different operations, and various different types of products we need to produce.",l.a.createElement("ol",null,l.a.createElement("li",null,"Machine 0 - Bottle Expansion Molding"),l.a.createElement("li",null,"Machine 1 - Water Cleaning or purifying Machine "),l.a.createElement("li",null,"Machine 2 - Pouring water / Filling Process "),l.a.createElement("li",null,"Machine 3 - Capping"),l.a.createElement("li",null,"Machine 4 - Labelling")),"This factory produces 4 different types of water bottles, and each water bottling operation must be run in the following order:",l.a.createElement("ol",null,l.a.createElement("li",null,l.a.createElement("span",{style:{backgroundColor:"".concat(d(0))}},"Job 0 - Spring Water 16oz "),l.a.createElement("ol",null,l.a.createElement("li",null,"Bottle Expansion - 10 seconds"),l.a.createElement("li",null,"Water Purifying - 30 seconds"),l.a.createElement("li",null,"Water Filling - 10 seconds"),l.a.createElement("li",null,"Bottle Capping - 10 seconds"),l.a.createElement("li",null,"Bottle Labeling - 8 seconds"))),l.a.createElement("li",null,l.a.createElement("span",{style:{backgroundColor:"".concat(d(1))}},"Job 1 - Distilled Water 16 oz"),l.a.createElement("ol",null,l.a.createElement("li",null,"Bottle Expansion - 50 seconds"),l.a.createElement("li",null,"Water Purifying - 60 seconds"),l.a.createElement("li",null,"Water Filling - 10 seconds"),l.a.createElement("li",null,"Bottle Capping - 10 seconds"),l.a.createElement("li",null,"Bottle Labeling - 16 seconds"))),l.a.createElement("li",null,l.a.createElement("span",{style:{backgroundColor:"".concat(d(2))}},"Job 2 - Distilled Water 32 oz"),l.a.createElement("ol",null,l.a.createElement("li",null,"Bottle Expansion - 30 seconds"),l.a.createElement("li",null,"Water Purifying - 90 seconds"),l.a.createElement("li",null,"Water Filling - 20 seconds"),l.a.createElement("li",null,"Bottle Capping - 10 seconds"),l.a.createElement("li",null,"Bottle Labeling - 16 seconds"))),l.a.createElement("li",null,l.a.createElement("span",{style:{backgroundColor:"".concat(d(3))}},"Job 3 - Bottoled Water 32 oz"),l.a.createElement("ol",null,l.a.createElement("li",null,"Bottle Expansion - 15 seconds"),l.a.createElement("li",null,"Water Purifying - 90 seconds"),l.a.createElement("li",null,"Water Filling - 20 seconds"),l.a.createElement("li",null,"Bottle Capping - 10 seconds"),l.a.createElement("li",null,"Bottle Labeling - 10 seconds")))),"Algorithm that runs in the background finds the most optimal way of running all the jobs in the given order. The Chart shows the order in which each job must run on each machine to complete all bottling activities in the most efficient manner. Watch the chart change as the algorithm finds more and more efficient way to run the factory."))}}]),t}(l.a.Component);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));r.a.render(l.a.createElement(x,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()}))}},[[33,1,2]]]);
//# sourceMappingURL=main.beebaffb.chunk.js.map